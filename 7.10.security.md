### **7.10.Security**   

---  

만약 클래스 패스 내에 스프링 시큐리티가 있다면 해당 애플리케이션은 기본적으로 시큐리티가 적용된다. 스프링 부트는 스프링 시큐리티의 content-negotiation 전략에 따라 ```HttpBasic```혹은 ```formLogin``` 사용 여부를 결정한다. 웹 애플리케이션 내에서 메소드 시큐리티를 사용하고 싶은 경우에는 ```@EnableGlobalMethodSecurity``` 추가하면 된다. 상세 정보는 [Spring Security Reference Guide](https://docs.spring.io/spring-security/site/docs/5.5.2/reference/html5/#jc-method) 에서 얻을 수 있다.     

기본적으로 ```UserDetailsService``` 는 한명의 사용자를 갖는다. 사용자의 이름은 ```name``` 이며 패스워드는 무작위로 결정된다. 아래 보이는 것처럼 애플리케이션이 시작할 때 ```INFO``` 레벨로 패스워드를 출력해 준다.      

```text
Using generated security password: 78fa095d-3f4c-48b1-ad50-e24c31d5cf35
```     

>**(Note)**   
> 로그 설정은 분리해 놓았다면 ```org.springframework.boot.autoconfigure.security``` 카테고리에 ```INFO``` 레벨로 설정되어 있는지 확인해 봐야 한다. 그렇지 않으면 패스워드가 출력되지 않는다.    

사용자 이름과 패스워드도 ```spring.security.user.name```, ```spring.security.user.password``` 로 변경가능하다.      

웹 애플리케이션에 기본적으로 제공되는 내용이다.    

* 인 메모리를 사용하는 ```UserDetailsService``` (WebFlux 인 경우 ```ReactiveUserDetailsService```) 빈과 자동 패스워드로 구성된 단일 사용자 (사용자와 관련된 프로퍼티는 ``` SecurityProperties.User``` 참고)
* 애플리케이션에서 사용할 (클래스 패스에 액츄에이터가 있다면 엑츄에이터 엔드포인트 포함) 폼 기반 로그인 또는 HTTP Basic 보안 (```Accept``` 헤더에 따라 달라짐) 
* 인증 관련 이벤트를 공지하기 위한 ```DefaultAuthenticationEventPublisher```    

다른 ````AuthenticationEventPublisher```` 를 사용하고 싶다면 다른 빈을 추가하면 된다.    

---

**7.10.1.MVC Security**   

---

기본 시큐리티 설정은 ```SecurityAutoConfiguration``` 과 ```UserDetailsServiceAutoConfiguration``` 에서 구현한다. ```SecurityAutoConfiguration``` 는 웹 보안을 위해 ```SpringBootWebSecurityConfiguration``` 를 임포트가 필요하며  ```UserDetailsServiceAutoConfiguration``` 은 웹 애플리케이션이 아닌 경우에도 관련된 인증 설정을 구성해 준다. 기본 웹 애플리케이션 시큐리티 설정을 끄거나 OAuth2 클라이언트나 리소스 서버같은 여러 가지 시큐리티 컴포넌트를 조합하려면 ```SecurityFilterChain``` 타입 빈을 추가한다.(이렇게 해도 ```UserDetailsService``` 설정이나 엑츄에이터 시큐리티는 비 활성화되지 않는다.)    


```UserDetailsService``` 설정도 사용하지 않으려면 ```UserDetailsService```, ```AuthenticationProvider```, ```AuthenticationManager``` 타입 빈을 추가하면 된다.     

커스텀 ```SecurityFilterChain``` 이나 ```WebSecurityConfigurerAdapter``` 빈을 추가하여 접근 규칙을 재 정의할 수 있다. 스프링 부트에서는 엑츄에이터 엔드 포인와 정적 리소 접근 규칙을 쉽게 재 정의할 수 있도록 해준다. ```management.endpoints.web.base-path```과 같이 프로퍼티 기반으로 ```RequestMatcher``` 생성할 때는 ```EndpointRequest``` 를 사용할 수 있다. 공통 리소스에 대한 ```RequestMatcher``` 를 사용할 때는 ```PathRequest``` 를 사용하면 된다.     


---

